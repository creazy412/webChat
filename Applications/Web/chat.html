<!DOCTYPE HTML>
<html>
	<head>
		<title>demo</title>
		<meta charset="utf-8" />
		<link href="css/chat.css" type="text/css" rel="stylesheet">
		<link href="css/jquery-plugin-v1.0.0.css" type="text/css" rel="stylesheet">
	</head>
	<body>
		<div class="container">
			<!--联系人-->
			<div class="contact">
				<!--搜索框-->
				<div class="search-box">
					<div class="search">
						<i class="chat-icon search-icon"></i>
						<input type="text" class="search-contact" placeholder="搜索" />
					</div>
					<!--搜索结果-->
					<div class="search-result">
						<p><img class="avatar" src="./default_34_34.jpg" width="22px">陈明</p>
						<p><img class="avatar no-login" src="./default_34_34.jpg" width="22px">陈明</p>
						<p><img class="avatar" src="./default_34_34.jpg" width="22px">陈明</p>
						<p><img class="avatar" src="./default_34_34.jpg" width="22px">陈明</p>
						<p><img class="avatar" src="./default_34_34.jpg" width="22px">陈明</p>
						<p><img class="avatar no-login" src="./default_34_34.jpg" width="22px">陈明</p>
						<p><img class="avatar" src="./default_34_34.jpg" width="22px">陈明</p>
						<p><img class="avatar" src="./default_34_34.jpg" width="22px">陈明</p>
					</div>
				</div>
				<!--联系人tab页-->
				<div class="contact-type">
					<div class="tab active" tab-name="recent" type="default">最近联系人</div>
					<div class="tab" tab-name="structure">组织架构</div>
				</div>
				<!--最近联系人-->
				<div id="nearest-contact" class="tab-detail recent active">
					<div class="tree-folders">
						<span class="no-child" type="personal" data-id="xieyx"><img class="avatar no-login" src="./default_34_34.jpg" width="22px">谢衍鑫<b class="unread">9</b></span>
                        <span class="no-child" type="personal"><img class="avatar no-login" src="./default_34_34.jpg" width="22px">刘书<b class="unread">2</b></span>
						<span type="group" data-id="cuihb-liushu-chenming">
							<div class="group-avatar">
								<img class="avatar" src="./default_34_34.jpg" width="10px">
								<img class="avatar no-login" src="./default_34_34.jpg" width="10px">
								<img class="avatar" src="./default_34_34.jpg" width="10px">
								<img class="avatar" src="./default_34_34.jpg" width="10px">
							</div>
							陈明、刘书
							<b class="unread">99</b>
						</span>
						<span type="group" data-id="cuihb-liushu-chenming">
							<div class="group-avatar">
								<img class="avatar" src="./default_34_34.jpg" width="10px">
								<img class="avatar no-login" src="./default_34_34.jpg" width="10px">
								<img class="avatar" src="./default_34_34.jpg" width="10px">
								<img class="avatar" src="./default_34_34.jpg" width="10px">
							</div>
							陈明、刘书
							<b class="unread">99</b>
						</span>
					</div>
					<div class="tree-files">
						<span class="no-child" type="member" data-id="chenming"><img class="avatar no-login" src="./default_34_34.jpg" width="22px">陈明</span>
                        <span class="no-child" type="member" data-id="cuihb"><img class="avatar no-login" src="./default_34_34.jpg" width="22px">崔洪波</span>
					</div>
					<div class="tree-files">
						<span class="no-child" type="member" data-id="chenming"><img class="avatar no-login" src="./default_34_34.jpg" width="22px">陈明</span>
                        <span class="no-child" type="member" data-id="cuihb"><img class="avatar no-login" src="./default_34_34.jpg" width="22px">崔洪波</span>
					</div>
				</div>
				<!--组织架构-->
				<div id="organization-structure" class="tab-detail structure">
					<div class="tree-folders">
						<span>管理层</span>
						<span>战略发展与投资部</span>
						<span class="no-child">视频部</span>
						<span class="no-child">技术部</span>
						<span>广告销售部</span>
						<span class="no-child">人力资源部</span>
                    </div>
					<div class="tree-files">
						<span class="no-child" type="member" data-id="chenming"><img class="avatar" src="./default_34_34.jpg" width="22px">陈明</span>
                       	<span class="no-child" type="member" data-id="liushu"><img class="avatar no-login" src="./default_34_34.jpg" width="22px">刘书</span>
                       	<span class="no-child" type="member" data-id="andyxu"><img class="avatar" src="./default_34_34.jpg" width="22px">徐进</span>
                       	<span class="no-child" type="member" data-id="bettyho"><img class="avatar" src="./default_34_34.jpg" width="22px">何晔</span>
                    </div>
                    <div class="tree-files">
						<div class="tree-folders">
							<span>战略BD组</span>
							<span class="no-child">创新产品组</span>
						</div>
						<div class="tree-files">
							<span class="no-child"><img class="avatar" src="./default_34_34.jpg" width="22px">邓少玮</span>
                            <span class="no-child"><img class="avatar" src="./default_34_34.jpg" width="22px">刘鼎森</span>
						</div>
                    </div>
                    <div class="tree-files">
						<div class="tree-folders">
							<span class="no-child"><img class="avatar" src="./default_34_34.jpg" width="22px">范丽茜</span>
							<span>华北区</span>
						</div>
						<div class="tree-files">
							<div class="tree-folders">
								<span class="no-child"><img class="avatar" src="./default_34_34.jpg" width="22px">池小燕</span>
								<span>华北业务管理部</span>
							</div>
							<div class="tree-files">
								<div class="tree-folders">
									<span class="no-child"><img class="avatar" src="./default_34_34.jpg" width="22px">卑晓艳</span>
									<span>华北媒介部</span>
									<span>内容产品中心</span>
								</div>
								<div class="tree-files">
									<span class="no-child"><img class="avatar" src="./default_34_34.jpg" width="22px">解丹</span>
								</div>
								<div class="tree-files">
									<span class="no-child"><img class="avatar" src="./default_34_34.jpg" width="22px">宫昊源</span>
								</div>
							</div>
						</div>
                     </div>
				</div>
				<div class="tool"></div>
			</div>
			<!--聊天详情-->
			<div class="detail">
				<!--当前联系人信息-->
				<div class="contact-msg" chatid="">
					<h1>进展如何了</h1>
					<p>谢衍鑫创建于2016-01-08 12:15:10</p>
					<div class="contact-tool">
						<i class="chat-icon add-group show-modal" modal-title="添加群成员" modal-data="addgroup.html"></i>
					</div>
				</div>
				<div class="chat-box">
					<!--联系人群组成员-->
					<div class="member">
						<div class="tree-folders">
							<span type="group">
								陈明、刘书
							</span>
						</div>
						<div class="tree-files">
							<span class="no-child" type="member"><img class="avatar" src="./default_34_34.jpg" width="22px">陈明</span>
                        	<span class="no-child" type="member"><img class="avatar no-login" src="./default_34_34.jpg" width="22px">刘书</span>
						</div>
					</div>
					<div class="message">
						<!--历史消息-->
						<div class="logs">
							<div class="row">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>崔洪波 - 2016-01-08 12:16:11</p>
									<div class="message-box">
										wget http://sourceforge.net/projects/levent/files/release-2.0.22-stable/libevent-2.0.22-stable.tar.gz/download
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
							<div class="row self">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>&nbsp;</p>
									<div class="message-box">
										wget http://sourceforge.net/projects/levent/files/release-2.0.22-stable/libevent-2.0.22-stable.tar.gz/download
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>崔洪波 - 2016-01-08 12:16:11</p>
									<div class="message-box">
										wget http://sourceforge.net/projects/levent/files/release-2.0.22-stable/libevent-2.0.22-stable.tar.gz/download
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>崔洪波 - 2016-01-08 12:16:11</p>
									<div class="message-box">
										wget http://sourceforge.net/projects/levent/files/release-2.0.22-stable/libevent-2.0.22-stable.tar.gz/download
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>崔洪波 - 2016-01-08 12:16:11</p>
									<div class="message-box">
										wget http://sourceforge.net/projects/levent/files/release-2.0.22-stable/libevent-2.0.22-stable.tar.gz/download
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>崔洪波 - 2016-01-08 12:16:11</p>
									<div class="message-box">
										wget http://sourceforge.net/projects/levent/files/release-2.0.22-stable/libevent-2.0.22-stable.tar.gz/download
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>崔洪波 - 2016-01-08 12:16:11</p>
									<div class="message-box">
										wget http://sourceforge.net/projects/levent/files/release-2.0.22-stable/libevent-2.0.22-stable.tar.gz/download
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>崔洪波 - 2016-01-08 12:16:11</p>
									<div class="message-box">
										wget http://sourceforge.net/projects/levent/files/release-2.0.22-stable/libevent-2.0.22-stable.tar.gz/download
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>崔洪波 - 2016-01-08 12:16:11</p>
									<div class="message-box">
										<img src="images/demo.jpg" width=100%/>
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="user-avatar"><img class="avatar" src="./default_34_34.jpg"></div>
								<div class="message-detail">
									<p>崔洪波 - 2016-01-08 12:16:11</p>
									<div class="message-box">
										<div class="files"><div class="file-msg"><p>会议.docx</p><p>10.5kb</p></div><div class="file-tool"><a href="javascript:;">保存</a></div></div>
										<i class="chat-icon message-box-pike"></i>
									</div>
								</div>
							</div>
						</div>
						<!--消息发送-->
						<div class="send-msg">
							<div class="tool">
								<a class="chat-icon smile" href="javascript:;"></a>
								<i class="chat-icon image show-modal" modal-title="上传图片" modal-data="upload.html"></i>
								<i class="chat-icon audio"></i>
								<i class="chat-icon remind"></i>
								<i class="chat-icon history"></i>
								<div class="pop-smiley" id="demo">
									<a href="javascript:;" data-face="face0" title="微笑"></a>	
									<a href="javascript:;" data-face="face1" title="撇嘴"></a>	
									<a href="javascript:;" data-face="face2" title="色"></a>	
									<a href="javascript:;" data-face="face3" title="发呆"></a>	
									<a href="javascript:;" data-face="face4" title="得意"></a>	
									<a href="javascript:;" data-face="face5" title="流泪"></a>	
									<a href="javascript:;" data-face="face6" title="害羞"></a>	
									<a href="javascript:;" data-face="face7" title="闭嘴"></a>	
									<a href="javascript:;" data-face="face8" title="睡"></a>	
									<a href="javascript:;" data-face="face9" title="大哭"></a>	
									<a href="javascript:;" data-face="face10" title="尴尬"></a>	
									<a href="javascript:;" data-face="face11" title="发怒"></a>	
									<a href="javascript:;" data-face="face12" title="调皮"></a>	
									<a href="javascript:;" data-face="face13" title="龇牙"></a>	
									<a href="javascript:;" data-face="face14" title="惊讶"></a>	
									<a href="javascript:;" data-face="face15" title="难过"></a>	
									<a href="javascript:;" data-face="face16" title="酷"></a>	
									<a href="javascript:;" data-face="face17" title=""></a>	
									<a href="javascript:;" data-face="face18" title=""></a>	
									<a href="javascript:;" data-face="face19" title=""></a>	
									<a href="javascript:;" data-face="face20" title=""></a>	
									<a href="javascript:;" data-face="face21" title=""></a>	
									<a href="javascript:;" data-face="face22" title=""></a>	
									<a href="javascript:;" data-face="face23" title=""></a>	
									<a href="javascript:;" data-face="face24" title=""></a>	
									<a href="javascript:;" data-face="face25" title=""></a>	
									<a href="javascript:;" data-face="face26" title=""></a>	
									<a href="javascript:;" data-face="face27" title=""></a>	
									<a href="javascript:;" data-face="face28" title=""></a>	
									<a href="javascript:;" data-face="face29" title=""></a>	
									<a href="javascript:;" data-face="face30" title=""></a>	
									<a href="javascript:;" data-face="face31" title=""></a>	
									<a href="javascript:;" data-face="face32" title=""></a>	
									<a href="javascript:;" data-face="face33" title=""></a>	
									<a href="javascript:;" data-face="face34" title=""></a>	
									<a href="javascript:;" data-face="face35" title=""></a>	
									<a href="javascript:;" data-face="face36" title=""></a>	
									<a href="javascript:;" data-face="face37" title=""></a>	
									<a href="javascript:;" data-face="face38" title=""></a>	
									<a href="javascript:;" data-face="face39" title=""></a>	
									<a href="javascript:;" data-face="face40" title=""></a>	
									<a href="javascript:;" data-face="face41" title=""></a>	
									<a href="javascript:;" data-face="face42" title=""></a>	
									<a href="javascript:;" data-face="face43" title=""></a>	
									<a href="javascript:;" data-face="face44" title=""></a>	
									<a href="javascript:;" data-face="face45" title=""></a>	
									<a href="javascript:;" data-face="face46" title=""></a>	
									<a href="javascript:;" data-face="face47" title=""></a>	
									<a href="javascript:;" data-face="face48" title=""></a>	
									<a href="javascript:;" data-face="face49" title=""></a>	
									<a href="javascript:;" data-face="face50" title=""></a>	
									<a href="javascript:;" data-face="face51" title=""></a>	
									<a href="javascript:;" data-face="face52" title=""></a>	
									<a href="javascript:;" data-face="face53" title=""></a>	
									<a href="javascript:;" data-face="face54" title=""></a>	
									<a href="javascript:;" data-face="face55" title=""></a>	
									<a href="javascript:;" data-face="face56" title=""></a>	
									<a href="javascript:;" data-face="face57" title=""></a>	
									<a href="javascript:;" data-face="face58" title=""></a>	
									<a href="javascript:;" data-face="face59" title=""></a>	
									<a href="javascript:;" data-face="face60" title=""></a>	
									<a href="javascript:;" data-face="face61" title=""></a>	
									<a href="javascript:;" data-face="face62" title=""></a>	
									<a href="javascript:;" data-face="face63" title=""></a>	
									<a href="javascript:;" data-face="face64" title=""></a>	
									<a href="javascript:;" data-face="face65" title=""></a>	
									<a href="javascript:;" data-face="face66" title=""></a>	
									<a href="javascript:;" data-face="face67" title=""></a>	
									<a href="javascript:;" data-face="face68" title=""></a>	
									<a href="javascript:;" data-face="face69" title=""></a>	
									<a href="javascript:;" data-face="face70" title=""></a>	
									<a href="javascript:;" data-face="face71" title=""></a>	
									<a href="javascript:;" data-face="face72" title=""></a>	
									<a href="javascript:;" data-face="face73" title=""></a>	
									<a href="javascript:;" data-face="face74" title=""></a>	
									<a href="javascript:;" data-face="face75" title=""></a>	
									<a href="javascript:;" data-face="face76" title=""></a>	
									<a href="javascript:;" data-face="face77" title=""></a>	
									<a href="javascript:;" data-face="face78" title=""></a>	
									<a href="javascript:;" data-face="face79" title=""></a>	
									<a href="javascript:;" data-face="face80" title=""></a>	
									<a href="javascript:;" data-face="face81" title=""></a>	
									<a href="javascript:;" data-face="face82" title=""></a>	
									<a href="javascript:;" data-face="face83" title=""></a>	
									<a href="javascript:;" data-face="face84" title=""></a>	
									<a href="javascript:;" data-face="face85" title=""></a>	
									<a href="javascript:;" data-face="face86" title=""></a>	
									<a href="javascript:;" data-face="face87" title=""></a>	
									<a href="javascript:;" data-face="face88" title=""></a>	
									<a href="javascript:;" data-face="face89" title=""></a>	
									<a href="javascript:;" data-face="face90" title=""></a>	
									<a href="javascript:;" data-face="face91" title=""></a>	
									<a href="javascript:;" data-face="face92" title=""></a>	
									<a href="javascript:;" data-face="face93" title=""></a>	
									<a href="javascript:;" data-face="face94" title=""></a>	
									<a href="javascript:;" data-face="face95" title=""></a>	
									<a href="javascript:;" data-face="face96" title=""></a>	
									<a href="javascript:;" data-face="face97" title=""></a>	
									<a href="javascript:;" data-face="face98" title=""></a>	
									<a href="javascript:;" data-face="face99" title=""></a>	
									<a href="javascript:;" data-face="face100" title=""></a>	
									<a href="javascript:;" data-face="face101" title=""></a>	
									<a href="javascript:;" data-face="face102" title=""></a>	
									<a href="javascript:;" data-face="face103" title=""></a>	
									<a href="javascript:;" data-face="face104" title=""></a>	
								</div>
							</div>
							<!--消息输入框-->
							<div class="chat-input" id="chat-input" contenteditable="true" spellcheck="false"></div>
							<!--消息发送按钮-->
							<div class="send-button">
								<a href="javascript:;" class="chat-icon more">&nbsp;</a>
								<a href="javascript:;" class="chat-icon button send">发送</a>
								<div class="pop-keys">
									<p class="active">按Enter键发送消息</p>
									<p>按Ctrl+Enter键发送消息</p>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="home"></div>
			</div>
		</div>
		<!--<div class="modal">
			<div class="modal-title">
				<h1>上传图片</h1>
				<a href="javascript:;" class="modal-close button-close">&times;</a>
			</div>
			<div class="modal-content">
				<a href="javascript:$('#send-pic').click();" class="button">选择图片</a>
				<span>（可以使用截图工具截图后在此Ctrl+V）</span>
				<input type="file" multiple="multiple" name="send-pic" id="send-pic" accept="image/*" style="
    width: 0;
    height: 0;
    float: left;
">
				<div class="image-lists" id="image-lists">
					
				</div>
				<a href="javascript:;" class="upload-img button float-right">发送</a>	
			</div>
		</div>
		<div class="modal-bg"></div>-->
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery-plugin-v1.0.0.js"></script>
		<script src="js/jquery.hotkeys.js"></script>
		<script src="js/pasteimage.js"></script>
		<script type="text/javascript" src="./js/chat.js"></script>
		<script type="text/javascript" src="./js/chatlazy.js"></script>
		<script src="js/main.js"></script>
		<script>
			var user = {
				'name':'谢衍鑫',
				'dataid':'xieyx',
				'avatar':'./default_34_34.jpg'
			};
			$(function(){
				$('.show-modal').click(function(){
					$(this).modal();
				})
			})
		</script>
		<script>
			var global_range=null;
			var obj = document.getElementById('chat-input');
			obj.setAttribute('oninput',document.all && !document.documentMode ? eval(function(){updateRange()}) : 'javascript:updateRange()');
            obj.setAttribute('onpropertychange',document.all && !document.documentMode ? eval(function(){updateRange()}) : 'javascript:updateRange()');
			obj.setAttribute('onclick',document.all && !document.documentMode ? eval(function(){updateRange()}) : 'javascript:updateRange()')
        	function updateRange(){
				if (window.getSelection){ 
					var sel = window.getSelection();
         			global_range = sel.getRangeAt(0);
				}
            }
			function cursorControl(a){
				this.element=a;
				this.range=!1;
				this.start=0;
				this.init();
			};
			cursorControl.prototype={
				init:function(){
					var _that=this;
					this.element.onkeyup=this.element.onmouseup=function(){
						this.focus();
						if(document.all){
							_that.range=document.selection.createRange();
						}else{
							_that.start=_that.getStart();
						}
					}
				},
				getType:function(){
					return Object.prototype.toString.call(this.element).match(/^\[object\s(.*)\]$/)[1];
				},
				getStart:function(){
					if (this.element.selectionStart || this.element.selectionStart == '0'){  
						return this.element.selectionStart; 
					}else if (window.getSelection){  
						var rng = window.getSelection().getRangeAt(0).cloneRange();  
						rng.setStart(this.element,0);  
						return rng.toString().length;
					}
				},
				insertText:function(text){
					this.element.focus();  
					if (document.all){
						var a = document.selection.createRange();  
						document.selection.empty();  
						a.pasteHTML(text); 
						a.collapse();  
						a.select();  
					}else{
						var start=this.getStart();
						if(this.getType()=='HTMLDivElement'){
							this.element.innerHTML=this.element.innerHTML.substr(0,start)+text+this.element.innerHTML.substr(start);
						}else{
							this.element.value=this.element.value.substr(0,start)+text+this.element.value.substr(start);
						}  
					} 
				}
			}; 
			function fn(id,str){
				if (window.getSelection){ 
					// IE9 and non-IE 
					sel = window.getSelection();
					if (sel.getRangeAt && sel.rangeCount) {	
						range = sel.getRangeAt(0);
						if(range.endContainer.id != id && range.endContainer.parentNode.id != id)
							range = global_range;
						if(range == null)
							return false;	
						range.deleteContents(); 
						var el = document.createElement('div'); 
						el.innerHTML = str; 
						var frag = document.createDocumentFragment(), node, lastNode; 
						while ( (node = el.firstChild) ) { 
							lastNode = frag.appendChild(node); 
						} 
						range.insertNode(frag); 
						if (lastNode) { 
							range = range.cloneRange(); 
							range.setStartAfter(lastNode); 
							range.collapse(true); 
							sel.removeAllRanges(); 
							sel.addRange(range); 
						}
						global_range = range;
					} 
				}else{ 
					var cc=new cursorControl(document.getElementById(id));
					cc.insertText(str);
				}
			};
		</script>
	</body>
</html>
